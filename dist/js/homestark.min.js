var hero=angular.module("superhero",["ui.bootstrap","ngRoute","homeStarkControllers","xeditable"]);hero.config(["$controllerProvider",function(e){e.allowGlobals()}]),hero.run(["editableOptions",function(e){e.theme="bs3"}]),hero.config(["$routeProvider",function(e){e.when("/dash",{templateUrl:"/pages/windows/dashboard.ejs",controller:""}).when("/devices",{templateUrl:"/pages/windows/devices.ejs",controller:""}).when("/about",{templateUrl:"/pages/windows/about.ejs",controller:""}).otherwise({redirectTo:"/dash",controller:""})}]);
$(document).ready(function(){$(".sidebar-brand").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled"),$("#wrapper").toggleClass("untoggled")})});
var homeStarkController=angular.module("homeStarkControllers",["ui.bootstrap","ngRoute","gridster","ui.knob","uiSwitch","angular-theme-spinner"]);homeStarkController.controller("loginCtrl",["$scope",function(t){t.loadLogin=function(){t["class"]="loading"}}]),homeStarkController.controller("devicesCtrl",["$scope","$http","$timeout",function(t,a,e){t.rowCollection=[],t.displayedCollection=[],t.displayedCollection=[].concat(t.rowCollection),t.$on("$destroy",function(){e.cancel(o)});var o=function(){time=e(o,3e4),a({method:"GET",url:"/devices/list"}).then(function(a){for(var e=0;e<a.data.length;e++)a.data[e].active===!0?a.data[e].active="Ativo":a.data[e].active="Inativo";t.rowCollection=a.data},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)})};o()}]),homeStarkController.controller("dashCtrl",["$scope","ShareDash","$uibModal","$timeout","$http",function(t,a,e,o,s){function n(t){for(var a=[],e=0;e<t.length;e++)"switch"==t[e].type&&("0"==t[e].value?t[e].value=!1:t[e].value=!0),a.push({status:t[e].active,sizeX:1,sizeY:1,type:t[e].type,value:t[e].value,name:t[e].name,updated:t[e].updated,hw:t[e].hw_assoc});return a}function l(a){for(var e=0;e<a.length;e++)"switch"==a[e].type&&("0"==a[e].value?a[e].value=!1:a[e].value=!0),t.dash_sensors[e].status=a[e].status,t.dash_sensors[e].value=a[e].value,t.dash_sensors[e].updated=a[e].updated}t.gridsterOpts={columns:6,pushing:!0,floating:!0,swapping:!0,width:"auto",colWidth:300,rowHeight:"match",margins:[10,10],outerMargin:!0,sparse:!1,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:2,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,resizable:{enabled:!0,handles:["n","e","s","w","ne","se","sw","nw"],start:function(t,a,e){},resize:function(t,a,e){},stop:function(t,a,e){}},draggable:{enabled:!0}},t.dash_sensors=[],t.options_water={readOnly:!0,unit:"%",subText:{enabled:!0,text:"Nível",color:"gray"},trackWidth:30,barWidth:30,step:1,trackColor:"rgba(52,152,219,.1)",barColor:"rgba(52,152,219,.5)"},t.options_light={readOnly:!0,subText:{enabled:!0,text:"Lux",color:"gray"},bgColor:"#2C3E50",trackWidth:50,barWidth:30,max:2e3,barColor:"#FFAE1A",textColor:"#eee"},t.$on("$destroy",function(){o.cancel(r)}),t.$on("$routeChangeStart",function(t,a,e){o.cancel(r)}),t.toggleSensor=function(a,e,o){var n={hw_assoc:e,type:"toggle"};s({url:"/dash/setData",method:"POST",data:n,headers:{"Content-Type":"application/json"}}).then(function(t){},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)})},t.toggleSwitch=function(a,e,o){var n={hw_assoc:e,value:a,type:o};s({url:"/dash/setData",method:"POST",data:n,headers:{"Content-Type":"application/json"}}).then(function(t){},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)})};var i=function(){t.showUpdate=!1},r=function(){time=o(r,1e4),t.showUpdate=!0,s({method:"GET",url:"/dash/list"}).then(function(a){o(i,3e3),a.data.length>t.dash_sensors.length?t.dash_sensors=n(a.data):l(a.data)},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)})};r(),t.dash=a,t.editDash=function(a,o,s,n,l,i){t.dash.hw=a,t.dash.type=o,t.dash.name=s,t.dash.value=n,t.dash.status=l,t.dash.updated=i;e.open({size:"lg",animation:!0,templateUrl:"modal.html",controller:"modalDashCtrl"})}}]),homeStarkController.controller("modalDashCtrl",["$scope","$timeout","$uibModalInstance","ShareDash","$http","$location",function(t,a,e,o,s,n){t.dash_sensor=o,s({url:"/dash/GetSensor",method:"POST",data:{hw:t.dash_sensor.hw},headers:{"Content-Type":"application/json"}}).then(function(a){a.data.active===!0?a.data.active="Ativo":a.data.active="Inativo",t.sensor=a.data},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)}),t.saveCfg=function(){s({url:"/dash/SaveDash",method:"POST",data:{name:t.dash_sensor.name,type:t.dash_sensor.type,hw:t.dash_sensor.hw},headers:{"Content-Type":"application/json"}}).then(function(t){console.log("Alterações salvas!")},function(a){t.data=a.data||"Request failed",t.status=a.status,console.log(t.status)})},t.cancel=function(){e.dismiss()}}]),homeStarkController.service("ShareDash",function(){var t={hw:"",type:"",value:"",name:"",status:"",updated:""};return t});